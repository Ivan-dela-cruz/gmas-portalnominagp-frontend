"use strict";(self.webpackChunkgmas_nomina_balcon=self.webpackChunkgmas_nomina_balcon||[]).push([[1379],{1379:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(9950),r=a(16673),n=a(93047),o=a(47553),i=a(5216),c=a(3951),l=a(97937),d=a(51024),m=a(43791),u=a(4695),p=a.n(u),x=a(44414);const b=e=>{const t=Math.floor(e/86400),a=String(Math.floor(e%86400/3600)).padStart(2,"0"),s=String(Math.floor(e%3600/60)).padStart(2,"0"),r=String(e%60).padStart(2,"0");return t>0?`${t} d\xedas y ${a}:${s}:${r}`:`${a}:${s}:${r}`},f=e=>{let{seconds:t}=e;const[a,r]=(0,s.useState)(t);return(0,s.useEffect)((()=>{if(a<=0)return;const e=setInterval((()=>{r((e=>e-1))}),1e3);return()=>clearInterval(e)}),[a]),(0,x.jsxs)("h1",{className:"text-white text-center",children:[(0,x.jsxs)("strong",{children:["Tiempo ",b(a)]})," "]})};var v=a(45834),h=a(8246);const g=e=>{let{token:t,setTokenValid:a}=e;const r=(0,h.Le)(t);return(0,s.useEffect)((()=>{r&&a(r)}),[t,r]),(0,x.jsx)(x.Fragment,{})},y=()=>{(0,m.A)();const[e,t]=(0,s.useState)(!1),[a,u]=(0,s.useState)(!1),b=(0,r.W6)(),h=(0,r.zy)(),[y,N]=(0,s.useState)({}),[j,A]=(0,s.useState)({tokenToApprove:"",tokenToDeny:"",startDate:"",endDate:"",days:"",credentialKey:"",observation:"",employeeName:"",approvalName:"",action:""}),C=new URLSearchParams(h.search);console.log("querytoken",C),(0,s.useEffect)((()=>{document.body.classList.add("h-100");const e=document.getElementById("root");e&&e.classList.add("h-100");const t=new URLSearchParams(h.search);return A((e=>({...e,tokenToApprove:t.get("token")||"",tokenToDeny:t.get("tokenToDeny")||"",startDate:t.get("startDate")||"",endDate:t.get("endDate")||"",days:t.get("days")||"",employeeName:`${t.get("employeeName")||""}`.toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase())),approvalName:`${t.get("approvalName")||""}`.toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase())),action:`${t.get("action")||""}`}))),()=>{document.body.classList.remove("h-100"),e&&e.classList.remove("h-100")}}),[h.search]);const S=e=>{A({...j,[e.target.name]:e.target.value})},k=async()=>{const e="Approve"===j.action?"  aprobada":"  rechazada",t={tokenToApprove:j.tokenToApprove,tokenToDeny:j.tokenToDeny,credentialKey:j.credentialKey,observation:j.observation};try{document.body.classList.add("spinner"),v.EB.post("/VacationRequests/Approve",t).then((t=>{null!==t&&void 0!==t&&t.data?(p().fire({icon:"success",title:`Solicitud ${e}`,text:`La solicitud ha sido ${e} exitosamente. El solicitante recibir\xe1 un correo con la resoluci\xf3n del caso.`,customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}),document.body.classList.remove("spinner"),b.push("/login")):(document.body.classList.remove("spinner"),window.location.reload())})).catch((e=>{var t;if(document.body.classList.remove("spinner"),null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&t.data){const t=e.response.data;"INVALID_CREDENTIALS"===(null===t||void 0===t?void 0:t.statusCode)?p().fire({icon:"warning",title:"\xa1Acceso denegado!",text:"Las credenciales ingresadas son incorrectas. Verifica tu contrase\xf1a o aseg\xfarate de que tienes permisos para realizar esta aprobaci\xf3n.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):"INVALID_TOKEN"===(null===t||void 0===t?void 0:t.statusCode)?p().fire({icon:"warning",title:"\xa1Token inv\xe1lido!",text:"El token de aprobaci\xf3n no es v\xe1lido. Puede haber expirado o haber sido utilizado previamente.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):"NOT_FOUND"===(null===t||void 0===t?void 0:t.statusCode)?p().fire({icon:"warning",title:"\xa1Solicitud no encontrada!",text:"La solicitud de aprobaci\xf3n ya no existe. Puede haber sido eliminada, procesada previamente o el enlace es incorrecto.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):"RESET_PASSWORD"===(null===t||void 0===t?void 0:t.statusCode)?u(!0):p().fire({icon:"error",title:"Error inesperado",text:"Ocurri\xf3 un problema al procesar la solicitud. Int\xe9ntalo nuevamente o contacta al administrador del sistema.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}else p().fire({icon:"error",title:"Error de conexi\xf3n",text:"No se pudo enviar la solicitud. Verifica tu conexi\xf3n a internet e int\xe9ntalo nuevamente.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}))}catch(a){document.body.classList.remove("spinner"),console.error("Error en la aprobaci\xf3n:",a),p().fire({icon:"error",title:"Error del sistema",text:"Se produjo un error inesperado. Int\xe9ntalo nuevamente o comun\xedcate con el administrador.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.A,{title:"Aprobaci\xf3n de Solicitudes",description:"Pagina para aprobaci\xf3n de solicitudes"}),(0,x.jsx)("div",{className:"d-flex justify-content-center align-items-center p-3",style:{minHeight:"100vh",width:"100%",top:0,left:0,position:"absolute",backgroundImage:"linear-gradient(240deg, var(--gradient-1) 20%, var(--gradient-1) 15%, var(--gradient-1-lighter))",backgroundAttachment:"fixed"},children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)(g,{token:j.tokenToApprove,setTokenValid:N}),(null===y||void 0===y?void 0:y.isValid)&&(0,x.jsx)(f,{seconds:(null===y||void 0===y?void 0:y.time)||0}),(0,x.jsx)(i.A,{style:{maxWidth:"430px",padding:"20px"},children:(0,x.jsxs)(i.A.Body,{className:"p-3",children:[(0,x.jsxs)("h5",{className:"text-danger text-center mb-0",children:[" Hola, ",j.approvalName]}),a?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("p",{style:{textAlign:"left"},className:"text-dark mt-2 mb-1",children:(0,x.jsx)("span",{style:{fontSize:"1em"},children:"Estimado usuario, al ser su primer acceso al sistema, es necesario que restablezca su contrase\xf1a. Por favor, haga clic en el siguiente enlace:"})}),(0,x.jsx)(n.k2,{className:"btn btn-info mb-1",to:"/forgot-password",children:"Restablecer contrase\xf1a"}),(0,x.jsx)("p",{className:"m-0",children:(0,x.jsxs)("strong",{children:[" ","Una vez completado este proceso, vuelva a itentar ","Approve"===j.action?" la aprobaci\xf3n ":" el rechazo "," de la solicitud."]})})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h5",{className:"text-dark text-center mb-0 mt-1",children:(0,x.jsxs)("b",{children:["Approve"===j.action?"Aprobar solicitud":"Rechazar solicitud"," de vacaci\xf3n"]})}),null!==y&&void 0!==y&&y.isValid?(0,x.jsxs)(c.A,{style:{textAlign:"left"},onSubmit:async e=>{if(e.preventDefault(),!j.credentialKey)return void p().fire({icon:"error",title:"Campo obligatorio",text:"Debe ingresar su contrase\xf1a para confirmar."});(await p().fire({title:"\xbfEsta seguro de enviar la respuesta?",icon:"question",showCancelButton:!0,confirmButtonText:"S\xed, enviar",cancelButtonText:"Cancelar",customClass:{confirmButton:"btn btn-info",cancelButton:" mx-2 btn btn-danger"},buttonsStyling:!1})).isConfirmed&&k()},children:[(0,x.jsxs)("p",{className:"text-dark mt-1",children:["Solicitud perteneciente a ",(0,x.jsx)("span",{style:{fontStyle:"italic",fontWeight:"600"},children:j.employeeName})," desde"," ",(0,x.jsx)("b",{children:j.startDate})," hasta ",(0,x.jsx)("b",{children:j.endDate})," total dias ",(0,x.jsx)("b",{children:j.days}),"."]}),(0,x.jsxs)(c.A.Group,{className:"mt-3",children:[(0,x.jsx)(c.A.Label,{children:(0,x.jsxs)("b",{children:["Contrase\xf1a: ",(0,x.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,x.jsx)(c.A.Control,{type:"password",name:"credentialKey",value:j.credentialKey,onChange:S,required:!0})]}),"Reject"===j.action&&(0,x.jsxs)(c.A.Group,{className:"mt-3",children:[(0,x.jsx)(c.A.Label,{children:(0,x.jsxs)("b",{children:["Observaci\xf3n: ",(0,x.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,x.jsx)(c.A.Control,{as:"textarea",required:!0,rows:3,name:"observation",value:j.observation,onChange:S})]}),(0,x.jsxs)(l.A,{variant:"Approve"===j.action?"info":"danger",type:"submit",className:"mt-4 w-100 btn-icon",children:["Approve"===j.action?(0,x.jsx)(o.A,{icon:"check-circle"}):(0,x.jsx)(o.A,{icon:"close-circle"}),"Approve"===j.action?"  Aprobar Solicitud":"  Rechazar Solicitud"]})]}):(0,x.jsxs)("p",{className:"text-dark",children:[" ","La solicitud ya no est\xe1 disponible. Esto puede deberse a que el tiempo ha expirado o ya ha sido aprobada/rechada previamente."]})]})]})})]})})]})}},5216:(e,t,a)=>{a.d(t,{A:()=>R});var s=a(48738),r=a.n(s),n=a(9950),o=a(44089),i=a(44414);const c=n.forwardRef(((e,t)=>{let{className:a,bsPrefix:s,as:n="div",...c}=e;return s=(0,o.oU)(s,"card-body"),(0,i.jsx)(n,{ref:t,className:r()(a,s),...c})}));c.displayName="CardBody";const l=c,d=n.forwardRef(((e,t)=>{let{className:a,bsPrefix:s,as:n="div",...c}=e;return s=(0,o.oU)(s,"card-footer"),(0,i.jsx)(n,{ref:t,className:r()(a,s),...c})}));d.displayName="CardFooter";const m=d;var u=a(22063);const p=n.forwardRef(((e,t)=>{let{bsPrefix:a,className:s,as:c="div",...l}=e;const d=(0,o.oU)(a,"card-header"),m=(0,n.useMemo)((()=>({cardHeaderBsPrefix:d})),[d]);return(0,i.jsx)(u.A.Provider,{value:m,children:(0,i.jsx)(c,{ref:t,...l,className:r()(s,d)})})}));p.displayName="CardHeader";const x=p,b=n.forwardRef(((e,t)=>{let{bsPrefix:a,className:s,variant:n,as:c="img",...l}=e;const d=(0,o.oU)(a,"card-img");return(0,i.jsx)(c,{ref:t,className:r()(n?`${d}-${n}`:d,s),...l})}));b.displayName="CardImg";const f=b,v=n.forwardRef(((e,t)=>{let{className:a,bsPrefix:s,as:n="div",...c}=e;return s=(0,o.oU)(s,"card-img-overlay"),(0,i.jsx)(n,{ref:t,className:r()(a,s),...c})}));v.displayName="CardImgOverlay";const h=v,g=n.forwardRef(((e,t)=>{let{className:a,bsPrefix:s,as:n="a",...c}=e;return s=(0,o.oU)(s,"card-link"),(0,i.jsx)(n,{ref:t,className:r()(a,s),...c})}));g.displayName="CardLink";const y=g;var N=a(27611);const j=(0,N.A)("h6"),A=n.forwardRef(((e,t)=>{let{className:a,bsPrefix:s,as:n=j,...c}=e;return s=(0,o.oU)(s,"card-subtitle"),(0,i.jsx)(n,{ref:t,className:r()(a,s),...c})}));A.displayName="CardSubtitle";const C=A,S=n.forwardRef(((e,t)=>{let{className:a,bsPrefix:s,as:n="p",...c}=e;return s=(0,o.oU)(s,"card-text"),(0,i.jsx)(n,{ref:t,className:r()(a,s),...c})}));S.displayName="CardText";const k=S,w=(0,N.A)("h5"),L=n.forwardRef(((e,t)=>{let{className:a,bsPrefix:s,as:n=w,...c}=e;return s=(0,o.oU)(s,"card-title"),(0,i.jsx)(n,{ref:t,className:r()(a,s),...c})}));L.displayName="CardTitle";const T=L,D=n.forwardRef(((e,t)=>{let{bsPrefix:a,className:s,bg:n,text:c,border:d,body:m=!1,children:u,as:p="div",...x}=e;const b=(0,o.oU)(a,"card");return(0,i.jsx)(p,{ref:t,...x,className:r()(s,b,n&&`bg-${n}`,c&&`text-${c}`,d&&`border-${d}`),children:m?(0,i.jsx)(l,{children:u}):u})}));D.displayName="Card";const R=Object.assign(D,{Img:f,Title:T,Subtitle:C,Body:l,Link:y,Text:k,Header:x,Footer:m,ImgOverlay:h})},22063:(e,t,a)=>{a.d(t,{A:()=>r});const s=a(9950).createContext(null);s.displayName="CardHeaderContext";const r=s}}]);