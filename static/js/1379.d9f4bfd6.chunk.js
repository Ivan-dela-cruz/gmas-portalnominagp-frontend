"use strict";(self.webpackChunkgmas_nomina_balcon=self.webpackChunkgmas_nomina_balcon||[]).push([[1379],{1379:(e,a,t)=>{t.r(a),t.d(a,{default:()=>y});var s=t(9950),r=t(16673),n=t(93047),o=t(47553),i=t(5216),c=t(3951),l=t(97937),d=t(51024),m=t(43791),u=t(4695),p=t.n(u),x=t(44414);const b=e=>{const a=Math.floor(e/86400),t=String(Math.floor(e%86400/3600)).padStart(2,"0"),s=String(Math.floor(e%3600/60)).padStart(2,"0"),r=String(e%60).padStart(2,"0");return a>0?`${a} d\xedas y ${t}:${s}:${r}`:`${t}:${s}:${r}`},f=e=>{let{seconds:a}=e;const[t,r]=(0,s.useState)(a);return(0,s.useEffect)((()=>{if(t<=0)return;const e=setInterval((()=>{r((e=>e-1))}),1e3);return()=>clearInterval(e)}),[t]),(0,x.jsxs)("h1",{className:"text-white text-center",children:[(0,x.jsxs)("strong",{children:["Tiempo ",b(t)]})," "]})};var h=t(45834),v=t(8246);const g=e=>{let{token:a,setTokenValid:t}=e;const r=(0,v.Le)(a);return(0,s.useEffect)((()=>{r&&t(r)}),[a,r]),(0,x.jsx)(x.Fragment,{})},y=()=>{(0,m.A)();const[e,a]=(0,s.useState)(!1),[t,u]=(0,s.useState)(!1),b=(0,r.W6)(),v=(0,r.zy)(),[y,N]=(0,s.useState)({}),[j,A]=(0,s.useState)({tokenToApprove:"",tokenToDeny:"",startDate:"",endDate:"",days:"",credentialKey:"",observation:"",employeeName:"",approvalName:"",action:""}),C=new URLSearchParams(v.search);console.log("querytoken",C),(0,s.useEffect)((()=>{document.body.classList.add("h-100");const e=document.getElementById("root");e&&e.classList.add("h-100");const a=new URLSearchParams(v.search);return A((e=>({...e,tokenToApprove:a.get("token")||"",tokenToDeny:a.get("tokenToDeny")||"",startDate:a.get("startDate")||"",endDate:a.get("endDate")||"",days:a.get("days")||"",employeeName:`${a.get("employeeName")||""}`.toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase())),approvalName:`${a.get("approvalName")||""}`.toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase())),action:`${a.get("action")||""}`}))),()=>{document.body.classList.remove("h-100"),e&&e.classList.remove("h-100")}}),[v.search]);const S=e=>{A({...j,[e.target.name]:e.target.value})},k=async()=>{const e={tokenToApprove:j.tokenToApprove,tokenToDeny:j.tokenToDeny,credentialKey:j.credentialKey,observation:j.observation};try{h.EB.post("/VacationRequests/Approve",e).then((e=>{null!==e&&void 0!==e&&e.data?(p().fire({icon:"success",title:"Solicitud aprobada",text:"La solicitud ha sido aprobada exitosamente. El solicitante recibir\xe1 un correo con la resoluci\xf3n del caso.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}),b.push("/login")):window.location.reload()})).catch((e=>{var a;if(null!==e&&void 0!==e&&null!==(a=e.response)&&void 0!==a&&a.data){const a=e.response.data;"INVALID_CREDENTIALS"===(null===a||void 0===a?void 0:a.statusCode)?p().fire({icon:"warning",title:"\xa1Acceso denegado!",text:"Las credenciales ingresadas son incorrectas. Verifica tu contrase\xf1a o aseg\xfarate de que tienes permisos para realizar esta aprobaci\xf3n.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):"INVALID_TOKEN"===(null===a||void 0===a?void 0:a.statusCode)?p().fire({icon:"warning",title:"\xa1Token inv\xe1lido!",text:"El token de aprobaci\xf3n no es v\xe1lido. Puede haber expirado o haber sido utilizado previamente.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):"NOT_FOUND"===(null===a||void 0===a?void 0:a.statusCode)?p().fire({icon:"warning",title:"\xa1Solicitud no encontrada!",text:"La solicitud de aprobaci\xf3n ya no existe. Puede haber sido eliminada, procesada previamente o el enlace es incorrecto.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):"RESET_PASSWORD"===(null===a||void 0===a?void 0:a.statusCode)?u(!0):p().fire({icon:"error",title:"Error inesperado",text:"Ocurri\xf3 un problema al procesar la solicitud. Int\xe9ntalo nuevamente o contacta al administrador del sistema.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}else p().fire({icon:"error",title:"Error de conexi\xf3n",text:"No se pudo enviar la solicitud. Verifica tu conexi\xf3n a internet e int\xe9ntalo nuevamente.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}))}catch(a){console.error("Error en la aprobaci\xf3n:",a),p().fire({icon:"error",title:"Error del sistema",text:"Se produjo un error inesperado. Int\xe9ntalo nuevamente o comun\xedcate con el administrador.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.A,{title:"Aprobaci\xf3n de Solicitudes",description:"Pagina para aprobaci\xf3n de solicitudes"}),(0,x.jsx)("div",{className:"d-flex justify-content-center align-items-center p-3",style:{minHeight:"100vh",width:"100%",top:0,left:0,position:"absolute",backgroundImage:"linear-gradient(240deg, var(--gradient-1) 20%, var(--gradient-1) 15%, var(--gradient-1-lighter))",backgroundAttachment:"fixed"},children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)(g,{token:j.tokenToApprove,setTokenValid:N}),(null===y||void 0===y?void 0:y.isValid)&&(0,x.jsx)(f,{seconds:(null===y||void 0===y?void 0:y.time)||0}),(0,x.jsx)(i.A,{style:{maxWidth:"430px",padding:"20px"},children:(0,x.jsxs)(i.A.Body,{className:"p-3",children:[(0,x.jsxs)("h5",{className:"text-danger text-center mb-0",children:[" Hola, ",j.approvalName]}),t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("p",{style:{textAlign:"left"},className:"text-dark mt-2 mb-1",children:(0,x.jsx)("span",{style:{fontSize:"1em"},children:"Estimado usuario, al ser su primer acceso al sistema, es necesario que restablezca su contrase\xf1a. Por favor, haga clic en el siguiente enlace:"})}),(0,x.jsx)(n.k2,{className:"btn btn-info mb-1",to:"/forgot-password",children:"Restablecer contrase\xf1a"}),(0,x.jsx)("p",{className:"m-0",children:(0,x.jsxs)("strong",{children:[" ","Una vez completado este proceso, vuelva a itentar ","Approve"===j.action?" la aprobaci\xf3n ":" el rechazo "," de la solicitud."]})})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h5",{className:"text-dark text-center mb-0 mt-1",children:(0,x.jsxs)("b",{children:["Approve"===j.action?"Aprobar solicitud":"Rechazar solicitud"," de vacaci\xf3n"]})}),null!==y&&void 0!==y&&y.isValid?(0,x.jsxs)(c.A,{style:{textAlign:"left"},onSubmit:async e=>{if(e.preventDefault(),!j.credentialKey)return void p().fire({icon:"error",title:"Campo obligatorio",text:"Debe ingresar su contrase\xf1a para confirmar."});(await p().fire({title:"\xbfEsta seguro de enviar la respuesta?",icon:"question",showCancelButton:!0,confirmButtonText:"S\xed, enviar",cancelButtonText:"Cancelar",customClass:{confirmButton:"btn btn-info",cancelButton:" mx-2 btn btn-danger"},buttonsStyling:!1})).isConfirmed&&k()},children:[(0,x.jsxs)("p",{className:"text-dark mt-1",children:["Solicitud perteneciente a ",(0,x.jsx)("span",{style:{fontStyle:"italic",fontWeight:"600"},children:j.employeeName})," desde"," ",(0,x.jsx)("b",{children:j.startDate})," hasta ",(0,x.jsx)("b",{children:j.endDate})," total dias ",(0,x.jsx)("b",{children:j.days}),"."]}),(0,x.jsxs)(c.A.Group,{className:"mt-3",children:[(0,x.jsx)(c.A.Label,{children:(0,x.jsxs)("b",{children:["Contrase\xf1a: ",(0,x.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,x.jsx)(c.A.Control,{type:"password",name:"credentialKey",value:j.credentialKey,onChange:S,required:!0})]}),"Reject"===j.action&&(0,x.jsxs)(c.A.Group,{className:"mt-3",children:[(0,x.jsx)(c.A.Label,{children:(0,x.jsxs)("b",{children:["Observaci\xf3n: ",(0,x.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,x.jsx)(c.A.Control,{as:"textarea",required:!0,rows:3,name:"observation",value:j.observation,onChange:S})]}),(0,x.jsxs)(l.A,{variant:"Approve"===j.action?"info":"danger",type:"submit",className:"mt-4 w-100 btn-icon",children:["Approve"===j.action?(0,x.jsx)(o.A,{icon:"check-circle"}):(0,x.jsx)(o.A,{icon:"close-circle"}),"Approve"===j.action?"  Aprobar Solicitud":"  Rechazar Solicitud"]})]}):(0,x.jsxs)("p",{className:"text-dark",children:[" ","La solicitud ya no est\xe1 disponible. Esto puede deberse a que el tiempo ha expirado o ya ha sido aprobada/rechada previamente."]})]})]})})]})})]})}},5216:(e,a,t)=>{t.d(a,{A:()=>R});var s=t(48738),r=t.n(s),n=t(9950),o=t(44089),i=t(44414);const c=n.forwardRef(((e,a)=>{let{className:t,bsPrefix:s,as:n="div",...c}=e;return s=(0,o.oU)(s,"card-body"),(0,i.jsx)(n,{ref:a,className:r()(t,s),...c})}));c.displayName="CardBody";const l=c,d=n.forwardRef(((e,a)=>{let{className:t,bsPrefix:s,as:n="div",...c}=e;return s=(0,o.oU)(s,"card-footer"),(0,i.jsx)(n,{ref:a,className:r()(t,s),...c})}));d.displayName="CardFooter";const m=d;var u=t(22063);const p=n.forwardRef(((e,a)=>{let{bsPrefix:t,className:s,as:c="div",...l}=e;const d=(0,o.oU)(t,"card-header"),m=(0,n.useMemo)((()=>({cardHeaderBsPrefix:d})),[d]);return(0,i.jsx)(u.A.Provider,{value:m,children:(0,i.jsx)(c,{ref:a,...l,className:r()(s,d)})})}));p.displayName="CardHeader";const x=p,b=n.forwardRef(((e,a)=>{let{bsPrefix:t,className:s,variant:n,as:c="img",...l}=e;const d=(0,o.oU)(t,"card-img");return(0,i.jsx)(c,{ref:a,className:r()(n?`${d}-${n}`:d,s),...l})}));b.displayName="CardImg";const f=b,h=n.forwardRef(((e,a)=>{let{className:t,bsPrefix:s,as:n="div",...c}=e;return s=(0,o.oU)(s,"card-img-overlay"),(0,i.jsx)(n,{ref:a,className:r()(t,s),...c})}));h.displayName="CardImgOverlay";const v=h,g=n.forwardRef(((e,a)=>{let{className:t,bsPrefix:s,as:n="a",...c}=e;return s=(0,o.oU)(s,"card-link"),(0,i.jsx)(n,{ref:a,className:r()(t,s),...c})}));g.displayName="CardLink";const y=g;var N=t(27611);const j=(0,N.A)("h6"),A=n.forwardRef(((e,a)=>{let{className:t,bsPrefix:s,as:n=j,...c}=e;return s=(0,o.oU)(s,"card-subtitle"),(0,i.jsx)(n,{ref:a,className:r()(t,s),...c})}));A.displayName="CardSubtitle";const C=A,S=n.forwardRef(((e,a)=>{let{className:t,bsPrefix:s,as:n="p",...c}=e;return s=(0,o.oU)(s,"card-text"),(0,i.jsx)(n,{ref:a,className:r()(t,s),...c})}));S.displayName="CardText";const k=S,w=(0,N.A)("h5"),T=n.forwardRef(((e,a)=>{let{className:t,bsPrefix:s,as:n=w,...c}=e;return s=(0,o.oU)(s,"card-title"),(0,i.jsx)(n,{ref:a,className:r()(t,s),...c})}));T.displayName="CardTitle";const D=T,L=n.forwardRef(((e,a)=>{let{bsPrefix:t,className:s,bg:n,text:c,border:d,body:m=!1,children:u,as:p="div",...x}=e;const b=(0,o.oU)(t,"card");return(0,i.jsx)(p,{ref:a,...x,className:r()(s,b,n&&`bg-${n}`,c&&`text-${c}`,d&&`border-${d}`),children:m?(0,i.jsx)(l,{children:u}):u})}));L.displayName="Card";const R=Object.assign(L,{Img:f,Title:D,Subtitle:C,Body:l,Link:y,Text:k,Header:x,Footer:m,ImgOverlay:v})},22063:(e,a,t)=>{t.d(a,{A:()=>r});const s=t(9950).createContext(null);s.displayName="CardHeaderContext";const r=s}}]);