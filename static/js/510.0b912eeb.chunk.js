"use strict";(self.webpackChunkgmas_nomina_balcon=self.webpackChunkgmas_nomina_balcon||[]).push([[510,5484],{35484:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var n=a(9950),s=a(16673),o=a(93047),r=a(76278),i=a(47553),l=a(5216),c=a(3951),d=a(97937),u=a(51024),m=a(43791),h=a(4695),f=a.n(h),b=a(45834),p=a(8246),x=a(17583),g=a(60666),v=a(44414);const C=e=>{let{token:t,setTokenValid:a}=e;const s=(0,p.Le)(t);return(0,n.useEffect)((()=>{s&&a(s)}),[t,s]),null},w=()=>{(0,m.A)();const e=(0,s.W6)(),t=(0,s.zy)(),[a,h]=(0,n.useState)({}),[p,w]=(0,n.useState)({token:"",username:"",names:""});(0,n.useEffect)((()=>{document.body.classList.add("h-100");const e=document.getElementById("root");e&&e.classList.add("h-100");const a=new URLSearchParams(t.search);return w((e=>({...e,token:a.get("token")||"",username:a.get("username")||"",names:`${a.get("names")||""}`.toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase()))}))),()=>{document.body.classList.remove("h-100"),e&&e.classList.remove("h-100")}}),[t.search]);const j=(0,x.Wx)({enableReinitialize:!0,initialValues:{password:"",passwordConfirm:""},validationSchema:g.Ik().shape({password:g.Yj().min(8,"La contrase\xf1a debe tener al menos 6 caracteres.").required("La contrase\xf1a es obligatoria."),passwordConfirm:g.Yj().required("Debe confirmar la contrase\xf1a.").oneOf([g.KR("password"),null],"Las contrase\xf1as deben coincidir.")}),onSubmit:async e=>{(await f().fire({title:"\xbfEst\xe1 seguro de actualizar su contrase\xf1a?",icon:"question",showCancelButton:!0,confirmButtonText:"S\xed, actualizar",cancelButtonText:"Cancelar",customClass:{confirmButton:"btn btn-info",cancelButton:"mx-2 btn btn-danger"},buttonsStyling:!1})).isConfirmed&&B(e)}}),{handleSubmit:y,handleChange:k,values:N,touched:S,errors:A}=j,B=async t=>{const a={username:p.username,password:t.password,authorizedToken:p.token};try{b.EB.post("/Security/update-password",a).then((t=>{null!==t&&void 0!==t&&t.data?(f().fire({icon:"success",title:"Contrase\xf1a actualizada",text:"Su contrase\xf1a ha sido actualizada correctamente. Inicie sesi\xf3n con su nueva contrase\xf1a.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}),e.push("/login")):window.location.reload()})).catch((e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&t.data){const t=e.response.data;"INVALID_TOKEN"===(null===t||void 0===t?void 0:t.statusCode)?f().fire({icon:"warning",title:"Token inv\xe1lido",text:"El enlace para restablecer la contrase\xf1a ha expirado o es inv\xe1lido. Por favor, solicite un nuevo enlace.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):"NOT_FOUND"===(null===t||void 0===t?void 0:t.statusCode)?f().fire({icon:"warning",title:"Solicitud no encontrada",text:"El enlace para restablecer la contrase\xf1a no existe o ya ha sido utilizado.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1}):f().fire({icon:"error",title:"Error inesperado",text:"Ocurri\xf3 un problema al actualizar su contrase\xf1a. Intente nuevamente o comun\xedquese con el administrador.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}else f().fire({icon:"error",title:"Error de conexi\xf3n",text:"No se pudo actualizar la contrase\xf1a. Verifique su conexi\xf3n a internet e intente nuevamente.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}))}catch(n){console.error("Error al actualizar la contrase\xf1a:",n),f().fire({icon:"error",title:"Error del sistema",text:"Se produjo un error inesperado. Intente nuevamente o comun\xedquese con el administrador.",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1})}},E=(0,v.jsxs)("div",{style:{height:"100%"},className:"d-flex align-items-center justify-content-center",children:[(0,v.jsx)(C,{token:p.token,setTokenValid:h}),(0,v.jsx)(l.A,{style:{maxWidth:"430px",padding:"20px"},children:(0,v.jsxs)(l.A.Body,{className:"p-3",children:[(0,v.jsxs)("h5",{className:"text-danger text-center mb-0",children:["Hola, ",p.names]}),(0,v.jsx)("h5",{style:{fontWeight:"600"},className:"text-dark text-center mb-3 mt-2",children:"Restablecer Contrase\xf1a"}),null!==a&&void 0!==a&&a.isValid?(0,v.jsxs)(c.A,{className:"tooltip-end-bottom",style:{textAlign:"left"},onSubmit:y,children:[(0,v.jsxs)("div",{className:"mb-3 filled",children:[(0,v.jsx)(i.A,{icon:"lock-off"}),(0,v.jsx)(c.A.Control,{type:"password",name:"password",onChange:k,value:N.password,placeholder:"Nueva Contrase\xf1a",required:!0}),A.password&&S.password&&(0,v.jsx)("div",{className:"d-block invalid-tooltip",children:A.password})]}),(0,v.jsxs)("div",{className:"mb-3 filled",children:[(0,v.jsx)(i.A,{icon:"lock-on"}),(0,v.jsx)(c.A.Control,{type:"password",name:"passwordConfirm",onChange:k,value:N.passwordConfirm,placeholder:"Confirmar Contrase\xf1a",required:!0}),A.passwordConfirm&&S.passwordConfirm&&(0,v.jsx)("div",{className:"d-block invalid-tooltip",children:A.passwordConfirm})]}),(0,v.jsxs)(d.A,{variant:"info",type:"submit",className:"mt-2 w-100 btn-icon",children:[(0,v.jsx)(i.A,{icon:"check-circle"}),"Actualizar Contrase\xf1a"]})]}):(0,v.jsx)("p",{className:"text-dark",children:"El enlace para restablecer la contrase\xf1a ha expirado o ya ha sido utilizado. Solicite un nuevo enlace."}),(0,v.jsx)("div",{className:"mt-4",children:(0,v.jsxs)(o.k2,{className:"float-start mt-3 mr-3 btn btn-outline-secondary",to:"/login",children:[(0,v.jsx)(i.A,{icon:"arrow-left"}),"Volver al inicio de sesi\xf3n"]})})]})})]});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.A,{title:"Restablecer Contrase\xf1a",description:"P\xe1gina para restablecer su contrase\xf1a"}),(0,v.jsx)(r.A,{right:E})]})}},50510:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});a(9950);var n=a(35484),s=a(44414);const o=()=>(0,s.jsx)(n.default,{})},76278:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(9950),s=a(43791),o=a(44414);const r=e=>{let{left:t,right:a}=e;return(0,s.A)(),(0,n.useEffect)((()=>{document.body.classList.add("h-100");const e=document.getElementById("root");return e&&e.classList.add("h-100"),()=>{document.body.classList.remove("h-100"),e&&e.classList.remove("h-100")}}),[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"d-flex justify-content-center align-items-center p-3",style:{height:"100vh",width:"100%",top:0,left:0,position:"absolute",backgroundImage:"linear-gradient(240deg, var(--gradient-1) 20%, var(--gradient-1) 15%, var(--gradient-1-lighter))",backgroundAttachment:"fixed"},children:a})})}}}]);